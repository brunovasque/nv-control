<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>NV-Control | ENAVIA</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="app">
      <!-- HEADER -->
      <header class="app-header">
        <div class="app-header-left">
          <h1>NV-Control</h1>
          <p class="subtitle">Painel de supervisão da ENAVIA</p>
        </div>
        <div class="app-header-right">
          <div class="worker-url">
            <label for="workerUrlInput">Worker:</label>
            <input
              id="workerUrlInput"
              type="text"
              spellcheck="false"
              value="https://nv-enavia.brunovasque.workers.dev"
            />
          </div>
          <div class="badges">
            <span id="status-badge" class="badge badge-neutral">Pronto</span>
            <span id="mode-badge" class="badge badge-mode badge-mode-chat"
              >CHAT</span
            >
          </div>
        </div>
      </header>

      <!-- MAIN -->
      <main class="app-main">
        <!-- LEFT: CONSOLE -->
        <section class="console">
          <div class="console-header">
            <span>Console NV-Control</span>
          </div>

          <div id="messages" class="messages"></div>

          <div class="input-area">
            <textarea
              id="userInput"
              rows="3"
              placeholder="Digite sua mensagem para a ENAVIA... (Ctrl+Enter para enviar)"
            ></textarea>
            <div class="input-toolbar">
              <div class="mode-buttons">
                <button
                  id="chatBtn"
                  type="button"
                  class="btn btn-secondary btn-mode active"
                >
                  Chat
                </button>
                <button
                  id="engineerBtn"
                  type="button"
                  class="btn btn-secondary btn-mode"
                >
                  Engineer
                </button>
                <button
                  id="brainBtn"
                  type="button"
                  class="btn btn-secondary btn-mode"
                >
                  Brain
                </button>
              </div>
              <div class="send-area">
                <label class="checkbox-inline">
                  <input id="debugToggle" type="checkbox" checked />
                  <span>Debug</span>
                </label>
                <button id="sendBtn" type="button" class="btn btn-primary">
                  Enviar
                </button>
              </div>
            </div>
          </div>
        </section>

        <!-- RIGHT: TELEMETRIA / HISTÓRICO / AVANÇADO -->
        <section class="side-panel">
          <div class="tabs">
            <button
              id="tab-telemetry"
              class="tab active"
              data-tab="telemetry"
            >
              Telemetria
            </button>
            <button id="tab-history" class="tab" data-tab="history">
              Histórico
            </button>
            <button id="tab-advanced" class="tab" data-tab="advanced">
              Avançado
            </button>
          </div>

          <div class="tab-panels">
            <!-- TELEMETRIA -->
            <div id="panel-telemetry" class="tab-panel active">
              <div class="card">
                <div class="card-header">
                  <span>Resumo</span>
                  <span class="card-badge" id="telemetry-summary-badge"
                    >-</span
                  >
                </div>
                <div id="telemetry-summary" class="card-body card-grid"></div>
              </div>

              <div class="card">
                <div class="card-header">
                  <span>Request</span>
                  <button
                    type="button"
                    class="btn-icon copy-btn"
                    data-copy-target="telemetry-request"
                    title="Copiar JSON do request"
                  >
                    Copiar
                  </button>
                </div>
                <pre id="telemetry-request" class="card-body code-block"></pre>
              </div>

              <div class="card">
                <div class="card-header">
                  <span>Response</span>
                  <button
                    type="button"
                    class="btn-icon copy-btn"
                    data-copy-target="telemetry-response"
                    title="Copiar JSON da response"
                  >
                    Copiar
                  </button>
                </div>
                <pre id="telemetry-response" class="card-body code-block"></pre>
              </div>

              <div class="card" id="telemetry-error-card" style="display:none;">
                <div class="card-header">
                  <span>Erro</span>
                  <button
                    type="button"
                    class="btn-icon copy-btn"
                    data-copy-target="telemetry-error"
                    title="Copiar detalhes de erro"
                  >
                    Copiar
                  </button>
                </div>
                <pre id="telemetry-error" class="card-body code-block"></pre>
              </div>
            </div>

            <!-- HISTÓRICO -->
<div id="panel-history" class="tab-panel">
  <div class="card">
    <div class="card-header">
      <span>Histórico de chamadas</span>

      <div class="header-actions">
        <button
          type="button"
          id="exportHistoryBtn"
          class="btn-icon"
          title="Exportar histórico"
        >
          Exportar
        </button>

        <button
          type="button"
          id="clearHistoryBtn"
          class="btn-icon"
          title="Limpar histórico"
        >
          Limpar
        </button>
      </div>
    </div>

    <div id="history-list" class="card-body history-list"></div>
  </div>
</div>

            <!-- AVANÇADO -->
            <div id="panel-advanced" class="tab-panel">
              <div class="card">
                <div class="card-header">
                  <span>Raw log da última interação</span>
                  <button
                    type="button"
                    class="btn-icon copy-btn"
                    data-copy-target="advanced-raw"
                    title="Copiar log completo"
                  >
                    Copiar
                  </button>
                </div>
                <pre id="advanced-raw" class="card-body code-block"></pre>
              </div>
            </div>
          </div>
        </section>
      </main>

      <!-- FOOTER -->
      <footer class="app-footer">
        <span>NV-Control • ENAVIA supervisionada (modo <strong>supervised</strong>)</span>
        <span class="hint"
          >Dica: use <strong>Chat</strong> para conversa normal, <strong>Engineer</strong> para
          plano/patch e <strong>Brain</strong> para treinamento.</span
        >
      </footer>
    </div>

    <script src="script.js"></script>
  </body>
</html>

